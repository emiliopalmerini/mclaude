// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.960
package productivity

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import (
	"claude-watcher/internal/shared/templates"
	"encoding/json"
	"fmt"
)

func Productivity(data ProductivityData) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Var2 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
			templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
			templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
			if !templ_7745c5c3_IsBuffer {
				defer func() {
					templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err == nil {
						templ_7745c5c3_Err = templ_7745c5c3_BufErr
					}
				}()
			}
			ctx = templ.InitializeContext(ctx)
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<h1>Productivity Analytics</h1><div class=\"time-range\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var3 = []any{"time-range__btn", templ.KV("time-range__btn--active", data.Range == "7d")}
			templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var3...)
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "<a href=\"/productivity?range=7d\" class=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var4 string
			templ_7745c5c3_Var4, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var3).String())
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/productivity/productivity.templ`, Line: 1, Col: 0}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var4))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "\">7D</a> ")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var5 = []any{"time-range__btn", templ.KV("time-range__btn--active", data.Range == "30d")}
			templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var5...)
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "<a href=\"/productivity?range=30d\" class=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var6 string
			templ_7745c5c3_Var6, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var5).String())
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/productivity/productivity.templ`, Line: 1, Col: 0}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var6))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "\">30D</a> ")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var7 = []any{"time-range__btn", templ.KV("time-range__btn--active", data.Range == "90d")}
			templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var7...)
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "<a href=\"/productivity?range=90d\" class=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var8 string
			templ_7745c5c3_Var8, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var7).String())
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/productivity/productivity.templ`, Line: 1, Col: 0}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var8))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 7, "\">90D</a></div><section><h2>Session Efficiency</h2><div class=\"stats-grid\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templates.StatsCard("Prompts/Session", fmt.Sprintf("%.1f", toFloat(data.Efficiency.AvgPromptsPerSession)), "sessions").Render(ctx, templ_7745c5c3_Buffer)
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templates.StatsCard("Tools/Session", fmt.Sprintf("%.1f", toFloat(data.Efficiency.AvgToolsPerSession)), "tokens").Render(ctx, templ_7745c5c3_Buffer)
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templates.StatsCard("Error Rate", fmt.Sprintf("%.1f%%", toFloat(data.Efficiency.ErrorRate)*100), "cost").Render(ctx, templ_7745c5c3_Buffer)
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templates.StatsCard("Avg Duration", fmt.Sprintf("%.0f min", toFloat(data.Efficiency.AvgDuration)/60), "sessions").Render(ctx, templ_7745c5c3_Buffer)
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 8, "</div></section><section><h2>Top Tools</h2><div class=\"charts-grid\"><div class=\"chart-card\"><div class=\"chart-card__title\">Tool Usage</div><div class=\"chart-card__container\"><canvas id=\"toolsChart\"></canvas></div></div><div class=\"chart-card\"><div class=\"chart-card__title\">Tool Breakdown</div><div class=\"chart-card__content\"><table class=\"data-table\"><thead><tr><th>Tool</th><th>Count</th></tr></thead> <tbody>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			for _, tool := range data.TopTools {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 9, "<tr><td>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var9 string
				templ_7745c5c3_Var9, templ_7745c5c3_Err = templ.JoinStringErrs(tool.Name)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/productivity/productivity.templ`, Line: 50, Col: 25}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var9))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 10, "</td><td>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var10 string
				templ_7745c5c3_Var10, templ_7745c5c3_Err = templ.JoinStringErrs(fmt.Sprintf("%d", tool.Count))
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/productivity/productivity.templ`, Line: 51, Col: 45}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var10))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 11, "</td></tr>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			}
			if len(data.TopTools) == 0 {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 12, "<tr><td colspan=\"2\" class=\"text-center\">No tool usage data</td></tr>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 13, "</tbody></table></div></div></div></section><section><h2>Time Patterns</h2><div class=\"charts-grid\"><div class=\"chart-card\"><div class=\"chart-card__title\">Activity by Day of Week</div><div class=\"chart-card__container\"><canvas id=\"dayOfWeekChart\"></canvas></div></div><div class=\"chart-card\"><div class=\"chart-card__title\">Activity by Hour of Day</div><div class=\"chart-card__container\"><canvas id=\"hourOfDayChart\"></canvas></div></div></div></section><section><h2>Efficiency Trends</h2><div class=\"charts-grid\"><div class=\"chart-card chart-card--full\"><div class=\"chart-card__title\">Daily Efficiency Metrics</div><div class=\"chart-card__container chart-card__container--full\"><canvas id=\"efficiencyTrendChart\"></canvas></div></div></div></section><div id=\"chartData\" style=\"display:none;\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var11 string
			templ_7745c5c3_Var11, templ_7745c5c3_Err = templ.JoinStringErrs(mustJSON(buildChartData(data)))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/productivity/productivity.templ`, Line: 96, Col: 76}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var11))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 14, "</div>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = chartsScript().Render(ctx, templ_7745c5c3_Buffer)
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			return nil
		})
		templ_7745c5c3_Err = templates.Layout("Productivity").Render(templ.WithChildren(ctx, templ_7745c5c3_Var2), templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

func chartsScript() templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var12 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var12 == nil {
			templ_7745c5c3_Var12 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 15, "<script>\n\t\t(function() {\n\t\t\tconst data = JSON.parse(document.getElementById('chartData').textContent);\n\n\t\t\tconst colors = {\n\t\t\t\tprimary: '#22c55e',\n\t\t\t\tsecondary: '#3b82f6',\n\t\t\t\ttertiary: '#f59e0b',\n\t\t\t\tgrid: '#1a1a1a',\n\t\t\t\ttext: '#666666'\n\t\t\t};\n\n\t\t\tconst baseOptions = {\n\t\t\t\tresponsive: true,\n\t\t\t\tmaintainAspectRatio: false,\n\t\t\t\tanimation: false,\n\t\t\t\tplugins: { legend: { labels: { color: colors.text } } },\n\t\t\t\tscales: {\n\t\t\t\t\tx: { grid: { color: colors.grid }, ticks: { color: colors.text } },\n\t\t\t\t\ty: { grid: { color: colors.grid }, ticks: { color: colors.text }, beginAtZero: true }\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// Top Tools Chart\n\t\t\tif (data.tools && data.tools.length > 0) {\n\t\t\t\tnew Chart(document.getElementById('toolsChart'), {\n\t\t\t\t\ttype: 'bar',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tlabels: data.tools.map(t => t.name),\n\t\t\t\t\t\tdatasets: [{\n\t\t\t\t\t\t\tlabel: 'Usage Count',\n\t\t\t\t\t\t\tdata: data.tools.map(t => t.count),\n\t\t\t\t\t\t\tbackgroundColor: colors.primary + '80',\n\t\t\t\t\t\t\tborderColor: colors.primary,\n\t\t\t\t\t\t\tborderWidth: 1\n\t\t\t\t\t\t}]\n\t\t\t\t\t},\n\t\t\t\t\toptions: {\n\t\t\t\t\t\t...baseOptions,\n\t\t\t\t\t\tindexAxis: 'y',\n\t\t\t\t\t\tplugins: { legend: { display: false } }\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Day of Week Chart\n\t\t\tconst dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n\t\t\tconst dayData = new Array(7).fill(0);\n\t\t\t(data.dayOfWeek || []).forEach(d => { dayData[d.day] = d.sessions; });\n\n\t\t\tnew Chart(document.getElementById('dayOfWeekChart'), {\n\t\t\t\ttype: 'bar',\n\t\t\t\tdata: {\n\t\t\t\t\tlabels: dayNames,\n\t\t\t\t\tdatasets: [{\n\t\t\t\t\t\tlabel: 'Sessions',\n\t\t\t\t\t\tdata: dayData,\n\t\t\t\t\t\tbackgroundColor: colors.secondary + '80',\n\t\t\t\t\t\tborderColor: colors.secondary,\n\t\t\t\t\t\tborderWidth: 1\n\t\t\t\t\t}]\n\t\t\t\t},\n\t\t\t\toptions: baseOptions\n\t\t\t});\n\n\t\t\t// Hour of Day Chart\n\t\t\tconst hourLabels = Array.from({length: 24}, (_, i) => `${i}:00`);\n\t\t\tconst hourData = new Array(24).fill(0);\n\t\t\t(data.hourOfDay || []).forEach(d => { hourData[d.hour] = d.sessions; });\n\n\t\t\tnew Chart(document.getElementById('hourOfDayChart'), {\n\t\t\t\ttype: 'bar',\n\t\t\t\tdata: {\n\t\t\t\t\tlabels: hourLabels,\n\t\t\t\t\tdatasets: [{\n\t\t\t\t\t\tlabel: 'Sessions',\n\t\t\t\t\t\tdata: hourData,\n\t\t\t\t\t\tbackgroundColor: colors.tertiary + '80',\n\t\t\t\t\t\tborderColor: colors.tertiary,\n\t\t\t\t\t\tborderWidth: 1\n\t\t\t\t\t}]\n\t\t\t\t},\n\t\t\t\toptions: baseOptions\n\t\t\t});\n\n\t\t\t// Efficiency Trend Chart\n\t\t\tif (data.trends && data.trends.length > 0) {\n\t\t\t\tnew Chart(document.getElementById('efficiencyTrendChart'), {\n\t\t\t\t\ttype: 'line',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tlabels: data.trends.map(t => t.period),\n\t\t\t\t\t\tdatasets: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'Avg Prompts',\n\t\t\t\t\t\t\t\tdata: data.trends.map(t => t.avgPrompts),\n\t\t\t\t\t\t\t\tborderColor: colors.primary,\n\t\t\t\t\t\t\t\tbackgroundColor: 'transparent',\n\t\t\t\t\t\t\t\ttension: 0.3\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'Avg Tools',\n\t\t\t\t\t\t\t\tdata: data.trends.map(t => t.avgTools),\n\t\t\t\t\t\t\t\tborderColor: colors.secondary,\n\t\t\t\t\t\t\t\tbackgroundColor: 'transparent',\n\t\t\t\t\t\t\t\ttension: 0.3\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'Sessions',\n\t\t\t\t\t\t\t\tdata: data.trends.map(t => t.sessions),\n\t\t\t\t\t\t\t\tborderColor: colors.tertiary,\n\t\t\t\t\t\t\t\tbackgroundColor: 'transparent',\n\t\t\t\t\t\t\t\ttension: 0.3,\n\t\t\t\t\t\t\t\tyAxisID: 'y1'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\toptions: {\n\t\t\t\t\t\t...baseOptions,\n\t\t\t\t\t\tscales: {\n\t\t\t\t\t\t\tx: baseOptions.scales.x,\n\t\t\t\t\t\t\ty: { ...baseOptions.scales.y, position: 'left' },\n\t\t\t\t\t\t\ty1: { ...baseOptions.scales.y, position: 'right', grid: { drawOnChartArea: false } }\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t})();\n\t</script>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

type chartData struct {
	Tools     []toolData  `json:"tools"`
	DayOfWeek []dayData   `json:"dayOfWeek"`
	HourOfDay []hourData  `json:"hourOfDay"`
	Trends    []trendData `json:"trends"`
}

type toolData struct {
	Name  string `json:"name"`
	Count int    `json:"count"`
}

type dayData struct {
	Day      int   `json:"day"`
	Sessions int64 `json:"sessions"`
}

type hourData struct {
	Hour     int   `json:"hour"`
	Sessions int64 `json:"sessions"`
}

type trendData struct {
	Period     string  `json:"period"`
	AvgPrompts float64 `json:"avgPrompts"`
	AvgTools   float64 `json:"avgTools"`
	Sessions   int64   `json:"sessions"`
}

func buildChartData(data ProductivityData) chartData {
	cd := chartData{
		Tools:     make([]toolData, len(data.TopTools)),
		DayOfWeek: make([]dayData, len(data.DayOfWeek)),
		HourOfDay: make([]hourData, len(data.HourOfDay)),
		Trends:    make([]trendData, len(data.DailyTrends)),
	}

	for i, t := range data.TopTools {
		cd.Tools[i] = toolData{Name: t.Name, Count: t.Count}
	}

	for i, d := range data.DayOfWeek {
		cd.DayOfWeek[i] = dayData{Day: toInt(d.DayOfWeek), Sessions: d.Sessions}
	}

	for i, h := range data.HourOfDay {
		cd.HourOfDay[i] = hourData{Hour: toInt(h.Hour), Sessions: h.Sessions}
	}

	for i, t := range data.DailyTrends {
		cd.Trends[i] = trendData{
			Period:     toString(t.Period),
			AvgPrompts: toFloat(t.AvgPrompts),
			AvgTools:   toFloat(t.AvgTools),
			Sessions:   t.Sessions,
		}
	}

	return cd
}

func mustJSON(v interface{}) string {
	b, _ := json.Marshal(v)
	return string(b)
}

func toFloat(v interface{}) float64 {
	switch val := v.(type) {
	case float64:
		return val
	case int64:
		return float64(val)
	case int:
		return float64(val)
	default:
		return 0
	}
}

func toInt(v interface{}) int {
	switch val := v.(type) {
	case int64:
		return int(val)
	case int:
		return val
	case float64:
		return int(val)
	default:
		return 0
	}
}

func toString(v interface{}) string {
	switch val := v.(type) {
	case string:
		return val
	default:
		return fmt.Sprintf("%v", v)
	}
}

var _ = templruntime.GeneratedTemplate
