// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: metrics.sql

package sqlc

import (
	"context"
	"database/sql"
)

const createSessionCommand = `-- name: CreateSessionCommand :exec
INSERT INTO session_commands (session_id, command, exit_code, executed_at)
VALUES (?, ?, ?, ?)
`

type CreateSessionCommandParams struct {
	SessionID  string         `json:"session_id"`
	Command    string         `json:"command"`
	ExitCode   sql.NullInt64  `json:"exit_code"`
	ExecutedAt sql.NullString `json:"executed_at"`
}

func (q *Queries) CreateSessionCommand(ctx context.Context, arg CreateSessionCommandParams) error {
	_, err := q.db.ExecContext(ctx, createSessionCommand,
		arg.SessionID,
		arg.Command,
		arg.ExitCode,
		arg.ExecutedAt,
	)
	return err
}

const createSessionFile = `-- name: CreateSessionFile :exec
INSERT INTO session_files (session_id, file_path, operation, operation_count)
VALUES (?, ?, ?, ?)
ON CONFLICT (session_id, file_path, operation) DO UPDATE SET
    operation_count = operation_count + excluded.operation_count
`

type CreateSessionFileParams struct {
	SessionID      string `json:"session_id"`
	FilePath       string `json:"file_path"`
	Operation      string `json:"operation"`
	OperationCount int64  `json:"operation_count"`
}

func (q *Queries) CreateSessionFile(ctx context.Context, arg CreateSessionFileParams) error {
	_, err := q.db.ExecContext(ctx, createSessionFile,
		arg.SessionID,
		arg.FilePath,
		arg.Operation,
		arg.OperationCount,
	)
	return err
}

const createSessionMetrics = `-- name: CreateSessionMetrics :exec
INSERT INTO session_metrics (session_id, message_count_user, message_count_assistant, turn_count, token_input, token_output, token_cache_read, token_cache_write, cost_estimate_usd, error_count)
VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
`

type CreateSessionMetricsParams struct {
	SessionID             string          `json:"session_id"`
	MessageCountUser      int64           `json:"message_count_user"`
	MessageCountAssistant int64           `json:"message_count_assistant"`
	TurnCount             int64           `json:"turn_count"`
	TokenInput            int64           `json:"token_input"`
	TokenOutput           int64           `json:"token_output"`
	TokenCacheRead        int64           `json:"token_cache_read"`
	TokenCacheWrite       int64           `json:"token_cache_write"`
	CostEstimateUsd       sql.NullFloat64 `json:"cost_estimate_usd"`
	ErrorCount            int64           `json:"error_count"`
}

func (q *Queries) CreateSessionMetrics(ctx context.Context, arg CreateSessionMetricsParams) error {
	_, err := q.db.ExecContext(ctx, createSessionMetrics,
		arg.SessionID,
		arg.MessageCountUser,
		arg.MessageCountAssistant,
		arg.TurnCount,
		arg.TokenInput,
		arg.TokenOutput,
		arg.TokenCacheRead,
		arg.TokenCacheWrite,
		arg.CostEstimateUsd,
		arg.ErrorCount,
	)
	return err
}

const createSessionTool = `-- name: CreateSessionTool :exec
INSERT INTO session_tools (session_id, tool_name, invocation_count, total_duration_ms, error_count)
VALUES (?, ?, ?, ?, ?)
ON CONFLICT (session_id, tool_name) DO UPDATE SET
    invocation_count = invocation_count + excluded.invocation_count,
    error_count = error_count + excluded.error_count
`

type CreateSessionToolParams struct {
	SessionID       string        `json:"session_id"`
	ToolName        string        `json:"tool_name"`
	InvocationCount int64         `json:"invocation_count"`
	TotalDurationMs sql.NullInt64 `json:"total_duration_ms"`
	ErrorCount      int64         `json:"error_count"`
}

func (q *Queries) CreateSessionTool(ctx context.Context, arg CreateSessionToolParams) error {
	_, err := q.db.ExecContext(ctx, createSessionTool,
		arg.SessionID,
		arg.ToolName,
		arg.InvocationCount,
		arg.TotalDurationMs,
		arg.ErrorCount,
	)
	return err
}

const getSessionMetricsBySessionID = `-- name: GetSessionMetricsBySessionID :one
SELECT session_id, message_count_user, message_count_assistant, turn_count, token_input, token_output, token_cache_read, token_cache_write, cost_estimate_usd, error_count FROM session_metrics WHERE session_id = ?
`

func (q *Queries) GetSessionMetricsBySessionID(ctx context.Context, sessionID string) (SessionMetric, error) {
	row := q.db.QueryRowContext(ctx, getSessionMetricsBySessionID, sessionID)
	var i SessionMetric
	err := row.Scan(
		&i.SessionID,
		&i.MessageCountUser,
		&i.MessageCountAssistant,
		&i.TurnCount,
		&i.TokenInput,
		&i.TokenOutput,
		&i.TokenCacheRead,
		&i.TokenCacheWrite,
		&i.CostEstimateUsd,
		&i.ErrorCount,
	)
	return i, err
}

const listSessionCommandsBySessionID = `-- name: ListSessionCommandsBySessionID :many
SELECT id, session_id, command, exit_code, executed_at FROM session_commands WHERE session_id = ? ORDER BY id ASC
`

func (q *Queries) ListSessionCommandsBySessionID(ctx context.Context, sessionID string) ([]SessionCommand, error) {
	rows, err := q.db.QueryContext(ctx, listSessionCommandsBySessionID, sessionID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []SessionCommand{}
	for rows.Next() {
		var i SessionCommand
		if err := rows.Scan(
			&i.ID,
			&i.SessionID,
			&i.Command,
			&i.ExitCode,
			&i.ExecutedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listSessionFilesBySessionID = `-- name: ListSessionFilesBySessionID :many
SELECT id, session_id, file_path, operation, operation_count FROM session_files WHERE session_id = ? ORDER BY operation_count DESC
`

func (q *Queries) ListSessionFilesBySessionID(ctx context.Context, sessionID string) ([]SessionFile, error) {
	rows, err := q.db.QueryContext(ctx, listSessionFilesBySessionID, sessionID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []SessionFile{}
	for rows.Next() {
		var i SessionFile
		if err := rows.Scan(
			&i.ID,
			&i.SessionID,
			&i.FilePath,
			&i.Operation,
			&i.OperationCount,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listSessionToolsBySessionID = `-- name: ListSessionToolsBySessionID :many
SELECT id, session_id, tool_name, invocation_count, total_duration_ms, error_count FROM session_tools WHERE session_id = ? ORDER BY invocation_count DESC
`

func (q *Queries) ListSessionToolsBySessionID(ctx context.Context, sessionID string) ([]SessionTool, error) {
	rows, err := q.db.QueryContext(ctx, listSessionToolsBySessionID, sessionID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []SessionTool{}
	for rows.Next() {
		var i SessionTool
		if err := rows.Scan(
			&i.ID,
			&i.SessionID,
			&i.ToolName,
			&i.InvocationCount,
			&i.TotalDurationMs,
			&i.ErrorCount,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
